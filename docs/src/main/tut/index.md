---
layout: home

---

# fuuid-annotation - Annotated FUUID's [![Build Status](https://travis-ci.com/ChristopherDavenport/fuuid-annotation.svg?branch=master)](https://travis-ci.com/ChristopherDavenport/fuuid-annotation) [![Maven Central](https://maven-badges.herokuapp.com/maven-central/io.chrisdavenport/fuuid-annotation_2.12/badge.svg)](https://maven-badges.herokuapp.com/maven-central/io.chrisdavenport/fuuid-annotation_2.12)

Automatically create an inner `Id` tagged `FUUID` type with convenient methods for its creation.

## Quick Start

To use fuuid-annotation in an existing SBT project with Scala 2.12 or a later version, add the following dependencies to your
`build.sbt` depending on your needs:

```scala
libraryDependencies ++= Seq(
  "io.chrisdavenport" %% "fuuid"            % "<fuuid-version>",
  "io.chrisdavenport" %% "fuuid-annotation" % "<version>"
)
```

Then, annotate your model's companion object:

```tut:silent
import io.chrisdavenport.fuuid.annotation.deriveId
import io.chrisdavenport.fuuid.FUUID
import cats.effect.IO

@deriveId
object User
```

Now the type `User.Id` is available and its companion object contains convenient methods for its creation:

- `apply` method receiving a valid `FUUID`:

```tut
User.Id(FUUID.fuuid("bd9686b6-efcd-434c-b4f4-f46b990c1808"))
```

- `apply` method receiving a valid `UUID` literal (uses a macro to compile-check the literal value):

```tut
User.Id("bd9686b6-efcd-434c-b4f4-f46b990c1808")
```

- `random` method that generates a new `Id` wrapped in an `F`

```tut
User.Id.random[IO]
```

- `Unsafe.random` method that generates a new `Id` unwrapped. This is an unsafe creation, it should only be used on a controlled environment, like tests:

```tut
User.Id.Unsafe.random
```

- `unapply` method to allow pattern-match a `String` into a valid `Id`:

```tut
"bd9686b6-efcd-434c-b4f4-f46b990c1808" match {
    case User.Id(userId) => userId
}
```

The annotation also provides instances for cats `Show`, `Order` and `Hash` (availables at `User._`)

## Doobie integration

A [doobie's Meta](https://git.io/fj64d) instance can also be autogenerated by using `deriveIdMeta` annotation (available in `fuuid-annotation-doobie`). This instance will allow you to use the generated `Id` type in doobie's queries.

You'll need to add the following dependencies to your `build.sbt`:
                  
```scala
libraryDependencies ++= Seq(
  "io.chrisdavenport" %% "fuuid"                   % "<fuuid-version>",
  "io.chrisdavenport" %% "fuuid-doobie"            % "<fuuid-version>",
  "io.chrisdavenport" %% "fuuid-annotation"        % "<version>",
  "io.chrisdavenport" %% "fuuid-annotation-doobie" % "<version>",
  "org.tpolecat"      %% "doobie-postgres"         % "<doobie-version>",
)
```

For the annotation to compile an implicit instance of `Meta[FUUID]` must be provided.

> A `Meta[FUUID]` instance can be provided by importing both `doobie.postgres.implicits_` and `io.chrisdavenport.fuuid.doobie.implicits_`.

```tut:silent
import doobie.postgres.implicits._
import io.chrisdavenport.fuuid.doobie.implicits._
```

Then, just add `deriveIdMeta` along with `deriveId`

```tut:silent
import io.chrisdavenport.fuuid.annotation.doobie.deriveIdMeta


@deriveId @deriveIdMeta
object Person
``` 

The `Meta[Id]` instance will be available under object `Person`. 

```tut:silent
import Person._
```

```tut
doobie.util.Meta[Person.Id]
```